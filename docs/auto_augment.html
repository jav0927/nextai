---

title: auto_agument


keywords: fastai
sidebar: home_sidebar

summary: "Implements Google AutoAugment augmentations."
description: "Implements Google AutoAugment augmentations."
nb_path: "03_auto_augment.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_auto_augment.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IN_COLAB</span> <span class="o">=</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">())</span>
<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
  <span class="o">!</span>pip install git+https://github.com/pete88b/nbdev_colab_helper.git
  <span class="kn">from</span> <span class="nn">nbdev_colab_helper.core</span> <span class="kn">import</span> <span class="o">*</span>
  <span class="n">project_name</span> <span class="o">=</span> <span class="s1">&#39;nextai&#39;</span>
  <span class="n">init_notebook</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting git+https://github.com/pete88b/nbdev_colab_helper.git
  Cloning https://github.com/pete88b/nbdev_colab_helper.git to /tmp/pip-req-build-1i5rg48q
  Running command git clone -q https://github.com/pete88b/nbdev_colab_helper.git /tmp/pip-req-build-1i5rg48q
Building wheels for collected packages: nbdev-colab-helper
  Building wheel for nbdev-colab-helper (setup.py) ... done
  Created wheel for nbdev-colab-helper: filename=nbdev_colab_helper-0.0.1-cp36-none-any.whl size=9695 sha256=98bf5cffdbf11992caad6cb1da100917c2b4911bcb6b38da7b2a30820738cd75
  Stored in directory: /tmp/pip-ephem-wheel-cache-yomu21os/wheels/11/52/f4/a49fbdda142e8992bb1695aa9eb30f499294a14cfb4b753fbe
Successfully built nbdev-colab-helper
Installing collected packages: nbdev-colab-helper
Successfully installed nbdev-colab-helper-0.0.1
Connecting to google drive
Mounted at /content/drive
/content/drive/My Drive/Colab Notebooks/github/nextai
pip install fastscript==1.0.0 fastcore==1.0.8 nbdev==1.0.14
   Collecting fastscript==1.0.0
  Downloading https://files.pythonhosted.org/packages/60/e4/7790e3ca100841566fdc1ccee413b9a9d40629d1858d86b1b9ffbc4fa75a/fastscript-1.0.0-py3-none-any.whl
Collecting fastcore==1.0.8
  Downloading https://files.pythonhosted.org/packages/53/3a/b2e5e18f20cf13285d7e5a87165386e916104b5eaad8c5d5a0f8c4c76f98/fastcore-1.0.8-py3-none-any.whl
Collecting nbdev==1.0.14
  Downloading https://files.pythonhosted.org/packages/7e/3c/6e05c52e16aab5a0406de7ca6c8f0df5d363f0519c7de66d25e5ef00a53a/nbdev-1.0.14-py3-none-any.whl (57kB)
Requirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from fastscript==1.0.0) (20.4)
Requirement already satisfied: pip in /usr/local/lib/python3.6/dist-packages (from fastscript==1.0.0) (19.3.1)
Requirement already satisfied: nbformat&gt;=4.4.0 in /usr/local/lib/python3.6/dist-packages (from nbdev==1.0.14) (5.0.7)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.6/dist-packages (from nbdev==1.0.14) (3.13)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.6/dist-packages (from nbdev==1.0.14) (5.3.5)
Requirement already satisfied: nbconvert&gt;=5.6.1 in /usr/local/lib/python3.6/dist-packages (from nbdev==1.0.14) (5.6.1)
Requirement already satisfied: ipykernel in /usr/local/lib/python3.6/dist-packages (from nbdev==1.0.14) (4.10.1)
Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from packaging-&gt;fastscript==1.0.0) (1.15.0)
Requirement already satisfied: pyparsing&gt;=2.0.2 in /usr/local/lib/python3.6/dist-packages (from packaging-&gt;fastscript==1.0.0) (2.4.7)
Requirement already satisfied: jupyter-core in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (4.6.3)
Requirement already satisfied: traitlets&gt;=4.1 in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (4.3.3)
Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (2.6.0)
Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (0.2.0)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.6/dist-packages (from jupyter-client-&gt;nbdev==1.0.14) (2.8.1)
Requirement already satisfied: pyzmq&gt;=13 in /usr/local/lib/python3.6/dist-packages (from jupyter-client-&gt;nbdev==1.0.14) (19.0.2)
Requirement already satisfied: tornado&gt;=4.1 in /usr/local/lib/python3.6/dist-packages (from jupyter-client-&gt;nbdev==1.0.14) (5.1.1)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.8.4)
Requirement already satisfied: jinja2&gt;=2.4 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (2.11.2)
Requirement already satisfied: pygments in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (2.6.1)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.6.0)
Requirement already satisfied: testpath in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.4.4)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (1.4.2)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.3)
Requirement already satisfied: bleach in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (3.2.1)
Requirement already satisfied: ipython&gt;=4.0.0 in /usr/local/lib/python3.6/dist-packages (from ipykernel-&gt;nbdev==1.0.14) (5.5.0)
Requirement already satisfied: decorator in /usr/local/lib/python3.6/dist-packages (from traitlets&gt;=4.1-&gt;nbformat&gt;=4.4.0-&gt;nbdev==1.0.14) (4.4.2)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.6/dist-packages (from jinja2&gt;=2.4-&gt;nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (1.1.1)
Requirement already satisfied: webencodings in /usr/local/lib/python3.6/dist-packages (from bleach-&gt;nbconvert&gt;=5.6.1-&gt;nbdev==1.0.14) (0.5.1)
Requirement already satisfied: simplegeneric&gt;0.8 in /usr/local/lib/python3.6/dist-packages (from ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.8.1)
Requirement already satisfied: prompt-toolkit&lt;2.0.0,&gt;=1.0.4 in /usr/local/lib/python3.6/dist-packages (from ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (1.0.18)
Requirement already satisfied: setuptools&gt;=18.5 in /usr/local/lib/python3.6/dist-packages (from ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (50.3.0)
Requirement already satisfied: pexpect; sys_platform != &#34;win32&#34; in /usr/local/lib/python3.6/dist-packages (from ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (4.8.0)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.6/dist-packages (from ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.7.5)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.6/dist-packages (from prompt-toolkit&lt;2.0.0,&gt;=1.0.4-&gt;ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.2.5)
Requirement already satisfied: ptyprocess&gt;=0.5 in /usr/local/lib/python3.6/dist-packages (from pexpect; sys_platform != &#34;win32&#34;-&gt;ipython&gt;=4.0.0-&gt;ipykernel-&gt;nbdev==1.0.14) (0.6.0)
Installing collected packages: fastscript, fastcore, nbdev
Successfully installed fastcore-1.0.8 fastscript-1.0.0 nbdev-1.0.14 
/content/drive/My Drive/Colab Notebooks/github/nextai
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Helper-functions">Helper functions<a class="anchor-link" href="#Helper-functions"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fastai2pil_basis" class="doc_header"><code>fastai2pil_basis</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fastai2pil_basis</code>(<strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pil2fastai_basis" class="doc_header"><code>pil2fastai_basis</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pil2fastai_basis</code>(<strong><code>b</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Transform an image in PIL format to Fastai tensor format</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="pil2tensor" class="doc_header"><code>pil2tensor</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L36" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>pil2tensor</code>(<strong><code>image</code></strong>:<code>PIL.Image</code>, <strong><code>dtype</code></strong>:<code>dtype</code>)</p>
</blockquote>
<p>Convert PIL style <code>image</code> array to torch style image tensor.
Imput -  image -image in PILImage form
output - image in FASTAI image format</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Flip a bounding box along the vertical axis</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="flip_horizontal" class="doc_header"><code>flip_horizontal</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>flip_horizontal</code>(<strong><code>bboxes</code></strong>)</p>
</blockquote>
<p>Flips a bounding box tensor along the vertical axis
Input:    bboxes - 2-d tensor containing bounding boxes in the format x1y1x2y2
Output:   Bounding boxes flipped along the vertical axis in the format x1y1x2y2</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Flip a bounding box along the horinzontal axis</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="flip_vertical" class="doc_header"><code>flip_vertical</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L58" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>flip_vertical</code>(<strong><code>bboxes</code></strong>)</p>
</blockquote>
<p>Flips a bounding box tensor along the horizontal axis
Input:    bboxes - 2-d tensor containing bounding boxes in the format x1y1x2y2
Output:   Bounding boxes flipped along the horizontal axis in the format x1y1x2y2</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Flip a bounding box along the vertical axis</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="swap_xy_coords" class="doc_header"><code>swap_xy_coords</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>swap_xy_coords</code>(<strong><code>bboxes</code></strong>)</p>
</blockquote>
<p>swap yx coordinate sequences in bounding boxes into xy sequences, and viceversa
Input:    bboxes - 2-d tensor containing bounding boxes
Output:   Bounding boxes flipped with swapped coordinate, xy --&gt; yx</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Basic rotation matrix</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotate_bb" class="doc_header"><code>rotate_bb</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotate_bb</code>(<strong><code>bb</code></strong>:<code>Tensor</code>, <strong><code>rads</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Rotate a bounding box (x1,y1,x2,y2) by an angle
Input:  bb -   bounding box  (needs to be off-cuda)
        rads - rotation angle in radians</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Bounding-Box-transformations">Bounding Box transformations<a class="anchor-link" href="#Bounding-Box-transformations"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="shear_x_bboxes" class="doc_header"><code>shear_x_bboxes</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L93" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>shear_x_bboxes</code>(<strong><code>bboxes</code></strong>:<code>Tensor</code>, <strong><code>factor</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Shear horizontally a tensor of bounding boxes
Input:
      bboxes  -      2-d tensor of bounding boxes associated with the image
      factor  -      Factor by which the image in sheared in the horizontal direction
Output:
      bboxes -       Sheared bounding boxes</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bb</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.75</span><span class="p">,</span><span class="mf">0.75</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">shear_x_bboxes</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span> <span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 0.1250, -0.2500,  1.0000,  0.7500]], device=&#39;cuda:0&#39;,
       dtype=torch.float64)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Data-Augmentation-algorithms">Data Augmentation algorithms<a class="anchor-link" href="#Data-Augmentation-algorithms"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ImageNetPolicy" class="doc_header"><code>class</code> <code>ImageNetPolicy</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L147" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ImageNetPolicy</code>(<strong><code>fillcolor</code></strong>=<em><code>(128, 128, 128)</code></em>)</p>
</blockquote>
<p>Augmentation policy for the ImageNet Dataset.
(As per the paper Learning Data Augmentation Strategies for Object detection. Barret Zoph, et. al. 6/26/2019)
The Policy is composed of a series of sub-policies.
Each sub-policy contains two (2) augmentation steps. i. e. 'posterize', 'rotate'
Each step consists of:
      (1) an operation i.e. 'posterize',
      (2) probability of application. i.e. 0.4, and
      (3) magnitude indicating the intensity of the operation.i.e 8
Author:  J. Adolfo Villalobos @ 2020</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SubPolicy" class="doc_header"><code>class</code> <code>SubPolicy</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L206" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SubPolicy</code>(<strong><code>operation1</code></strong>, <strong><code>p1</code></strong>, <strong><code>magnitude_idx1</code></strong>, <strong><code>operation2</code></strong>, <strong><code>p2</code></strong>, <strong><code>magnitude_idx2</code></strong>, <strong><code>fillcolor</code></strong>=<em><code>(128, 128, 128)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotate_bboxes" class="doc_header"><code>rotate_bboxes</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotate_bboxes</code>(<strong><code>bboxes</code></strong>:<code>Tensor</code>, <strong><code>degrees</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Rotate bounding boxes (in sync with a rotated image)
Input:
    bboxes :       tensor of bounding boxes in the format x1,y1,x2,y2
    degrees :      Angle in degrees to rotate the box as float
Output:
    bboxes         tensor of rotated bounding boxes</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="shear_x_bboxes" class="doc_header"><code>shear_x_bboxes</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L93" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>shear_x_bboxes</code>(<strong><code>bboxes</code></strong>:<code>Tensor</code>, <strong><code>factor</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Shear horizontally a tensor of bounding boxes
Input:
      bboxes  -      2-d tensor of bounding boxes associated with the image
      factor  -      Factor by which the image in sheared in the horizontal direction
Output:
      bboxes -       Sheared bounding boxes</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotate_bb" class="doc_header"><code>rotate_bb</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotate_bb</code>(<strong><code>bb</code></strong>:<code>Tensor</code>, <strong><code>rads</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Rotate a bounding box (x1,y1,x2,y2) by an angle
Input:  bb -   bounding box  (needs to be off-cuda)
        rads - rotation angle in radians</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="swap_xy_coords" class="doc_header"><code>swap_xy_coords</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>swap_xy_coords</code>(<strong><code>bboxes</code></strong>)</p>
</blockquote>
<p>swap yx coordinate sequences in bounding boxes into xy sequences, and viceversa
Input:    bboxes - 2-d tensor containing bounding boxes
Output:   Bounding boxes flipped with swapped coordinate, xy --&gt; yx</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="flip_horizontal" class="doc_header"><code>flip_horizontal</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L48" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>flip_horizontal</code>(<strong><code>bboxes</code></strong>)</p>
</blockquote>
<p>Flips a bounding box tensor along the vertical axis
Input:    bboxes - 2-d tensor containing bounding boxes in the format x1y1x2y2
Output:   Bounding boxes flipped along the vertical axis in the format x1y1x2y2</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotate_bboxes" class="doc_header"><code>rotate_bboxes</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotate_bboxes</code>(<strong><code>bboxes</code></strong>:<code>Tensor</code>, <strong><code>degrees</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Rotate bounding boxes (in sync with a rotated image)
Input:
    bboxes :       tensor of bounding boxes in the format x1,y1,x2,y2
    degrees :      Angle in degrees to rotate the box as float
Output:
    bboxes         tensor of rotated bounding boxes</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotate_bboxes" class="doc_header"><code>rotate_bboxes</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotate_bboxes</code>(<strong><code>bboxes</code></strong>:<code>Tensor</code>, <strong><code>degrees</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Rotate bounding boxes (in sync with a rotated image)
Input:
    bboxes :       tensor of bounding boxes in the format x1,y1,x2,y2
    degrees :      Angle in degrees to rotate the box as float
Output:
    bboxes         tensor of rotated bounding boxes</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rotate_bboxes" class="doc_header"><code>rotate_bboxes</code><a href="https://github.com/jav0927/nextai_lib/tree/main/nextai_lib/auto_augment.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rotate_bboxes</code>(<strong><code>bboxes</code></strong>:<code>Tensor</code>, <strong><code>degrees</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Rotate bounding boxes (in sync with a rotated image)
Input:
    bboxes :       tensor of bounding boxes in the format x1,y1,x2,y2
    degrees :      Angle in degrees to rotate the box as float
Output:
    bboxes         tensor of rotated bounding boxes</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

